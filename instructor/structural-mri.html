<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Getting Started With Neuroimaging Analysis: Structural MRI: Bias Correction, Segmentation and Image Registration</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav IDEAS"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="IDEAS" src="../assets/images/IDEAS-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../structural-mri.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav IDEAS" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="IDEAS" src="../assets/images/IDEAS-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Getting Started With Neuroimaging Analysis
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Getting Started With Neuroimaging Analysis
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Getting Started With Neuroimaging Analysis
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 18%" class="percentage">
    18%
  </div>
  <div class="progress IDEAS">
    <div class="progress-bar IDEAS" role="progressbar" style="width: 18%" aria-valuenow="18" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../structural-mri.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="imaging-data-structure-and-formats.html">1. Imaging Data: Structure And Formats</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. Structural MRI: Bias Correction, Segmentation and Image Registration
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#opening-up-an-image">Opening up an image</a></li>
<li><a href="#run-bias-correction-and-tissue-segmentation">Run Bias Correction and Tissue Segmentation</a></li>
<li><a href="#quality-check">Quality check</a></li>
<li><a href="#obtaining-volume">Obtaining volume</a></li>
<li><a href="#coregistration-to-standard-space">Coregistration to standard space</a></li>
<li><a href="#stretch-exercises">Stretch exercises</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="pet-imaging.html">3. Processing and analysing PET brain images</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="diffusion-weighted-imaging.html">4. Diffusion-weighted imaging (DWI)</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="functional-mri.html">5. Functional Magnetic Resonance Imaging (fMRI)</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="command-line.html">6. Extra: Using the Command Line</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/imaging-data-structure-and-formats.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/pet-imaging.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/imaging-data-structure-and-formats.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Imaging Data:
        </a>
        <a class="chapter-link float-end" href="../instructor/pet-imaging.html" rel="next">
          Next: Processing and... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Structural MRI: Bias Correction, Segmentation and Image Registration</h1>
        <p>Last updated on 2024-06-23 |
        
        <a href="https://github.com/HealthBioscienceIDEAS/aaic2024-neuroimaging-workshop/edit/main/episodes/structural-mri.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 65 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I process and quantify structural MRI scans?</li>
<li>How do I register MRI with other modalities?</li>
<li>How do I get key metrics out?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Perform basic pre-processing steps, such as bias correction and
tissue segmentation</li>
<li>Assess some common imaging artefacts in the sturctura MRI</li>
<li>Discover how to align and quantify neuroimaging data at regional
level</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="introduction"><h2 class="section-heading">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width"><p>In this section, you will be learning how to process and quantify
structural MRI scans. T1-weighted structural MRI scans are the
“workhorse” scan of dementia research. They provide high-resolution,
detailed pictures of a patient’s anatomy, allowing researchers to
visualize where atrophy caused by Alzheimer’s disease or other dementias
is occurring. In addition, it provides anatomical reference to other
imaging modalities, such as functional MRI and positron emission
tomography (PET), that provide lower-resolution maps of brain function
and pathology, so that regional quantification of key areas can be
assessed in these scans.</p>
<p>We will be using two widely used software packages: <a href="https://www.fil.ion.ucl.ac.uk/spm/" class="external-link">SPM</a> and <a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki" class="external-link">FSL</a>. These packages
provide analysis and visualization functionality of structural and
functional neuroimaging data, and they can be used in both
cross-sectional and longitudinal studies. The subsequent outputs from
these pipelines can be used in the quantification of other imaging
modalities.</p>
<p>After the course, you will be able to perform basic measurements
relevant to dementia research from structural MRI brain scans.</p>
<p>We will use the SPM and FSL tools to perform: * image visualization
of analysis outputs, * intensity inhomogeneity correction, * structural
MRI segmentation, * quantification of volumetric outputs, and *
registration to a standard space atlas.</p>
</section><section id="opening-up-an-image"><h2 class="section-heading">Opening up an image<a class="anchor" aria-label="anchor" href="#opening-up-an-image"></a>
</h2>
<hr class="half-width"><p>We are going to be working in the <code>StructuralMRI</code>
subfolder under <code>data</code> in your home directory.From the
previous lesson, you learned how to view and navigate images.</p>
<p>Clicking on the Applications in the upper left-hand corner and select
the terminal icon. This will open a terminal window that you will use to
type commands <img src="../fig/aic_smri_launch_terminal.png" alt="Launch the terminal" class="figure"></p>
<p>From the terminal window, type <code>fsleyes</code> to open up the
image and have a look around. <img src="../fig/aic_smri_fsleyes.png" alt="Open FSL eyes" class="figure"></p>
<p>Now we choose the file <code>sub-OAS_30003_T1w.nii</code> by going to
the File menu and choosing the Add Image command <img src="../fig/aic_smri_fsleyes_addfile.png" alt="Add file" class="figure"><img src="../fig/aic_smri_fsleyes_choosefile.png" alt="Choose File" class="figure"></p>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Close fsleyes and then re-open the viewer. This time use the other
image in the folder <code>sub-OAS30217_T1w.nii</code>.</p>
<p><em>What differences do you notice?</em></p>
</div>
</div>
</div>
</section><section id="run-bias-correction-and-tissue-segmentation"><h2 class="section-heading">Run Bias Correction and Tissue Segmentation<a class="anchor" aria-label="anchor" href="#run-bias-correction-and-tissue-segmentation"></a>
</h2>
<hr class="half-width"><p>Small variations in the magnetic field can result in changes in the
image intensity that vary slowly spatially. These variations are not due
to anatomical differences. We can visually identify this <em>image
inhomogeneity</em> in the white matter, where voxels in one part of the
brain might be so affected by it that they have similar intensity values
as grey matter voxels in other brain regions. However, the intensities
in the white matter voxels should be more or less uniform throughout the
brain. Any remaining inhomogeneity in the image can significantly
influence the results of automated image processing techniques, so we
need to correct for these effects. The process that removes this image
inhomogeneity is typically referred to as <em>bias correction</em>.</p>
<p>The next step is to reliably identify what type of tissue each voxel
contains. While the resolution of structural MRI is quite high
(typically around 1 mm), there is still the likelihood that a voxel will
contain more than one tissue in it. The process of <em>tissue
segmentation</em> looks at the voxel intensity, compares it to its
neighbours and prior information about what tissues we would expect to
have in that voxel and assigns a probability that the voxel contains
that tissue. It typically generates <em>n</em> different volumes, where
<em>n</em> is the number of tissue types you want to use to classify the
brain. We typically focus on three tissue probability maps in
particular: * Grey matter (GM), * White matter (WM), and * Cerebrospinal
fluid (CSF)</p>
<p>SPM performs the <em>bias correction</em> and <em>tissue
segmentation</em> steps simultaneously. Follow the steps below to obtain
bias-corrected images and tissue probability maps.</p>
<div class="section level3">
<h3 id="bias-correction-and-segmenation-steps">Bias Correction and Segmenation Steps<a class="anchor" aria-label="anchor" href="#bias-correction-and-segmenation-steps"></a></h3>
<ol style="list-style-type: decimal"><li>Type <code>spm pet</code> to launch SPM (screenshot) <img src="../fig/aic_smri_terminal_window.png" alt="Launch SPM" class="figure"></li>
<li>SPM will then create a number of windows. You want to look at the
Main Menu Window that has all of the buttons. <img src="../fig/aic_smri_spm.png" alt="SPM windows" class="figure"></li>
<li>From main menu, select the Segment button (Screenshots). This will
launch a window known as the <em>batch editor</em>, where you can adjust
settings on the pipeline to be run. <img src="../fig/aic_smri_seg_batch.png" alt="SPM Batch editor" class="figure"></li>
<li>Edit the options for segmentation:
<ol style="list-style-type: decimal"><li>Under Data-&gt;Channels-&gt;Volume, click on “Specify…”. <img src="../fig/aic_smri_seg_volumes.png" alt="Specify volumes" class="figure"></li>
<li>In the dialog box that opens up, please navigate to the folder
<code>data</code> and then <code>StructuralMRI</code>. Then select the
first image <code>sub-OAS30003_T1w.nii</code>. Once you click on it, you
will notice the file move down to the bottom of the box which represents
the list of selected files. <img src="../fig/aic_smri_seg_chooset1.png" alt="Choose T1 image" class="figure"></li>
<li>Click the Done button</li>
<li>Back in the batch editor, under Data-&gt;Save Bias Corrected, please
choose “Save Field and Corrected” ![Saving bias field and corrected
images] (fig/aic_smri_seg_bcoption.png){alt=“Choose bias correction
option”}</li>
<li>Under the Tissues section, please make sure that the first three
tissue types, which represent GM, WM, and CSF, have the native tissue
subfield set to native, while the final three tissue types (4-6), which
represent non-brain structures, have the native tissue subfield set to
None. ![Only saving input from first three tissues]
(fig/aic_smri_seg_native.png){alt=“Native segmentation”}</li>
</ol></li>
<li>Click the green run button to start! It should take about 5-10
minutes. You will see a lot of other things happening in other windows.
The terminal will say <code>Done - Segment</code> when it has
finished.</li>
</ol></div>
</section><section id="quality-check"><h2 class="section-heading">Quality check<a class="anchor" aria-label="anchor" href="#quality-check"></a>
</h2>
<hr class="half-width"><p>The quality check is an important part of any analysis. We are going
to visualize the outputs from SPM Segment and make sure that the bias
correction and segmentation have worked.</p>
<div class="section level3">
<h3 id="bias-correction">Bias correction<a class="anchor" aria-label="anchor" href="#bias-correction"></a></h3>
<ol style="list-style-type: decimal"><li>Use <code>fsleyes</code> again and open up the original image
<code>sub-OAS30003_T1w.nii</code> as you did at the start of the
session.</li>
<li>Change the image lookup table to <code>NIH</code> <img src="../fig/aic_smri_fsleyes_selectnih.png" alt="FSL eyes with NIH colormap" class="figure"></li>
<li>Then change the image minimum to 40 and the maximum to 600. This
means that all intensities 40 and below will map to the first color in
the lookup table, and all voxels 600 and above will map to the last
color. The white matter should be yellow to red. <img src="../fig/aic_smri_fsleyes_minmax.png" alt="Change min and max intensity" class="figure"><br></li>
<li>Next add the bias corrected image, which is called
<code>msub-OAS30003_T1w.nii</code>. Change the lookup table to NIH as
you did in Step 2. Change the minimum to 40 and maximum intensity to 500
similar to what you did in Step 2 and 3. <img src="../fig/aic_smri_fsleyes_biasnih.png" alt="Bias in image using NIH map" class="figure"></li>
</ol><p>When you add this image, it will overlay on top of the original
image. Think of this new image a completely opaque, so that you no
longer see the original one. If you want to see the original one, then
you need to either turn it off using the eye icon right by the file, or
you need to turn the opacity (slider near the top of the screen which is
marked opacity.)</p>
<div id="exercise-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>Use the eye icon in the overlay list right next to the file
<code>msub-OAS30003_T1w.nii</code> and turn this image off and on many
times. This will allow you to compare with the original image.</p>
<p><em>What do you notice about the image in the white matter area when
comparing the bias correct and original image?</em></p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="tissue-segmentation">Tissue segmentation<a class="anchor" aria-label="anchor" href="#tissue-segmentation"></a></h3>
<p>Now that we are happy with the bias correction, lets look at the
tissue segmentation. 1. Use the icon to turn off the original image.
Select the bias corrected image and make sure the colormap is back to
the first option “Greyscale” <img src="../fig/aic_smri_fsleyes_orig.png" alt="Bias correted image in greyscale" class="figure"> 1. Now add the grey matter
probability image <code>c1sub-OAS30003_T1w.nii</code>. 1. Choose the
probability map and set the lookup table to Red. Change the minimum
intensity to 0.2 and the maximum intensity to 0.9. This will eliminate
some noise from very low probability voxels. 1. Use the opacity slider
to make the grey matter probability map transparent. <img src="../fig/aic_smri_fsleyes_gm.png" alt="Looking at grey matter image" class="figure">
1. Look around the image, zoom in places, and try turning the grey
matter probability map off and on. The goal is to make sure the grey
matter probability map is not: 1. Missing any grey matter 1. Not
including other tissue (WM, CSF, non-brain tissue that has a similar
intensity to GM)</p>
<div id="exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise 3<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<div class="callout-content">
<p>Now do the same steps with the white matter image
<code>c2sub-OAS30003_T1w.nii</code> and the cerebrospinal fluid image
<code>c3sub-OAS30003_T1w.nii</code>. Choose different color
colormaps.</p>
<p><em>Do these images look like they have identified the white matter
and CSF in the T1 weighted image correctly?</em></p>
</div>
</div>
</div>
</div>
</section><section id="obtaining-volume"><h2 class="section-heading">Obtaining volume<a class="anchor" aria-label="anchor" href="#obtaining-volume"></a>
</h2>
<hr class="half-width"><p>One thing that we are often interested in is to obtain the actual
volume of grey matter, or a particular brain region. There are helpful
utilities in FSL to extract the volume from the tissue probability maps.
First we will change our working directory to the Structural MRI
folder:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="bu">cd</span> ~/data/StructuralMRI</span></code></pre>
</div>
<p>Then we will run this command to get the total grey matter
volume:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">fslstats</span> c1sub-OAS30003_T1w.nii <span class="at">-V</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Produce output for this command</code></pre>
</div>
<p>This will produce two numbers. The first number is the number of
voxels in the grey matter. These voxels as discussed earlier have
physical dimensions indicating how the volume that each individual voxel
represents. So the second value indicates the total volume of the grey
matter (usually represented in units of cubic millimeters).</p>
</section><section id="coregistration-to-standard-space"><h2 class="section-heading">Coregistration to standard space<a class="anchor" aria-label="anchor" href="#coregistration-to-standard-space"></a>
</h2>
<hr class="half-width"><p>MRI scans can be acquired in any orientation. Even when we think we
are getting a sagittal or coronal acquisition, the patient may end up in
the scanner at a slant. This makes it difficult to identify key
anatomical landmarks. We may also want to compare common anatomical
structures across a whole sample of subjects. The main solution to this
is to use <em>image registration</em> to orient our images and align
them with a standard anatomical coordinate system. In this case, we will
be aligning our data to the Montreal Neurological Institute <a href="https://mcin.ca/research/neuroimaging-methods/atlases/" class="external-link">MNI152
atlas</a>. We are not looking to perform an exact voxel to voxel match
between our image and the atlas. Instead, we just want to align the
images such that the orientation and the relative size are aligned.</p>
<div class="section level3">
<h3 id="skull-stripping">Skull stripping<a class="anchor" aria-label="anchor" href="#skull-stripping"></a></h3>
<p>Before we can perform the registration, we will use the tissue
probability maps to <em>skull strip</em> the image. Skull stripping
removes the non-brain tissue (scalp, dura, neck, eyes, etc) from the
image. Before we run the commands, let’s first check what working
directory we are in by using the command <code>pwd</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">pwd</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Produce correct output for pwd</code></pre>
</div>
<p>If you have a different output from the above, then run the following
command:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">cd</span> ~/data/StructuralMRI</span></code></pre>
</div>
<p>First we will use the FSL utility <code>fslmaths</code> to create a
brain mask by using the tissue probability maps from SPM.
<code>fslmaths</code> is a great swiss-army knife utility to do lots of
helpful little image processing bits.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">fslmaths</span> c1sub-OAS30003_T1w.nii <span class="at">-add</span> c2sub-OAS30003_T1w.nii <span class="at">-add</span> c3sub-OAS30003_T1w.nii <span class="at">-thr</span> 0.5 <span class="at">-bin</span> sub-OAS30003_T1w_brain_mask.nii</span></code></pre>
</div>
<p>Let’s break this command down a little bit:</p>
<ul><li>First, we state the command we want to run
<code>fslmaths</code>
</li>
<li>We then specify our input image, the GM map
<code>c1sub-OAS30003_T1w.nii</code>
</li>
<li>We then specify the first operation <code>-add</code>
</li>
<li>We then specify what we want to add to our input image. In this
case, it is the WM map <code>c2sub-OAS30003_T1w.nii</code>. The
resulting image would contain the probability that a voxel is either GM
or WM.</li>
<li>We then specify that we want to add another image, and this time it
is the CSF map. This image now holds the probability that a voxel is GM,
WM, or CSF, which are the three main tissue types in the brain that we
want to process.</li>
<li>We will then threshold this image at 0.5 using the
<code>-thr 0.5</code> option. This says to only keep voxels who have a
probability of 0.5 or greater. All other voxels are set to 0.</li>
<li>Our final operation is to <em>binarize</em> the image. Any values
that are not zero are set to one. This creates a mask which says whether
the voxel is inside (<strong>1</strong>) or outside (<strong>0</strong>)
of the brain.<br></li>
<li>Finally, we save our results into the new image file
<code>sub-OAS30003_T1w_brain_mask.nii</code>
</li>
</ul><p>Now that we have created a mask, we are going to remove all the
information outside of the mask using the following command:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">fslmaths</span> msub-OAS30003_T1w.nii <span class="at">-mas</span> sub-OAS30003_T1w_brain_mask.nii.gz msub-OAS30003_T1w_brain.nii</span></code></pre>
</div>
<p>This command masks our bias corrected image with the brain mask and
makes a new file which has the name
<code>msub-OAS30003_T1w_brain.nii</code>. Take a look at the image in
<code>fsleyes</code>. <img src="../fig/aic_smri_fsleyes_skullstripped.png" alt="Skull stripped image" class="figure"></p>
<p>We will then use the FSL registration program <a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FLIRT" class="external-link">FLIRT</a> to align
our image to the standard space MNI152. Please follow the steps below:
1. On the terminal window, please type in the following command
<code>Flirt</code> 1. This will open a dialog box. We will change the
following settings: 1. For reference image, click on the folder icon and
choose the image <code>MNI152_T1_1mm_brain</code> 1. For the input
image, please select the mask we created above
<code>msub-OAS30003_T1w_brain.nii</code> 1. For the output image, please
type in a new name <code>msub-OAS30003_T1w_brain_MNI.nii</code> The
final command setup should look like the screenshot below. <img src="../fig/aic_smri_flirt.png" alt="FLIRT window" class="figure"></p>
<p>If your window looks like this, then click the <strong>Go</strong>
button at the bottom, in the terminal, you will see the <em>command
line</em> program that would run what you have set up in the dialog box.
If you were to select that command and run it in the terminal it would
do the same thing.</p>
</div>
<div class="section level3">
<h3 id="quality-check-1">Quality check<a class="anchor" aria-label="anchor" href="#quality-check-1"></a></h3>
<p>Let’s open <code>fsleyes</code> and open the output from the
co-registration <code>msub-OAS30003_T1w_brain_MNI.nii</code>. <img src="../fig/aic_smri_fsleyes_mnispace.png" alt="T1w in MNI space" class="figure"></p>
<p>Now click on the Add Standard function. This is where fsleyes keeps
all of the standard atlases and templates so that you can quickly access
them. <img src="../fig/aic_smri_fsleyes_addstd.png" alt="Add standard function" class="figure"></p>
<p>Select the <code>MNI152_T1_1mm_brain</code> from this list of files.
<img src="../fig/aic_smri_fsleyes_choosemni.png%20%7Balt=%22Choose%20MNI%20image%22%7D" class="figure"></p>
<p>We can now check if our image is registered by flicking back and
forth between the MNI image and our image.</p>
</div>
</section><section id="stretch-exercises"><h2 class="section-heading">Stretch exercises<a class="anchor" aria-label="anchor" href="#stretch-exercises"></a>
</h2>
<hr class="half-width"><p>If you have completed all of the above and want to keep working on
more structural imaging data, please try the exercises below.</p>
<div id="bonus-exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="bonus-exercise-1" class="callout-inner">
<h3 class="callout-title">BONUS Exercise 1<a class="anchor" aria-label="anchor" href="#bonus-exercise-1"></a>
</h3>
<div class="callout-content">
<p>Extract the volumes from the WM and CSF probability maps for
<code>sub-OAS30003_T1w.nii</code>.</p>
<p><em>What are the three tissue volumes?</em></p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>TODO: add the solution of the three tissue volumes</p>
</div>
</div>
</div>
</div>
<div id="bonus-exercise-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="bonus-exercise-2" class="callout-inner">
<h3 class="callout-title">BONUS Exercise 2<a class="anchor" aria-label="anchor" href="#bonus-exercise-2"></a>
</h3>
<div class="callout-content">
<p>The volumes that come out of <code>fslstats</code> assume that each
voxel is completely full of GM, even though for some voxels the
probability may be very small. That can lead to inaccuracies, so there
are a couple of ways we can more accurately measure from tissue
probability maps.</p>
<p>Before we start, let’s make sure we are in the right working
directory by using the <code>cd</code> command.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="bu">cd</span> ~/data/StructuralMRI</span></code></pre>
</div>
<p>The first approach is to only count voxels with a
<strong>majority</strong> of GM. So we will threshold by the value of
0.5 before calculating our volume.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">fslstats</span> c1sub-OAS30003_T1w.nii <span class="at">-l</span> 0.5 <span class="at">-V</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>TODO: Output of fslstats</code></pre>
</div>
<p>The second approach is to get the mean and volume of the all the
non-zero voxels.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">fslstats</span> c1sub-OAS30003_T1w.nii <span class="at">-M</span> <span class="at">-V</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>TODO: Output of fslstats</code></pre>
</div>
<p>This will produce three numbers: 1. The mean of the non-zero voxels
2. The number of voxels greater than zero. 3. The volume of the voxels
greater than zero.</p>
<p>If you multiply (1) by (3), this would be what we call the
<em>probabilistic</em> volume of the GM and it accurately accounts the
amount of GM in each voxel.</p>
<p><em>How do these volumes compare with the original volume you
obtained?</em></p>
</div>
</div>
</div>
<div id="bonus-exercise-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="bonus-exercise-3" class="callout-inner">
<h3 class="callout-title">BONUS Exercise 3<a class="anchor" aria-label="anchor" href="#bonus-exercise-3"></a>
</h3>
<div class="callout-content">
<p>Let’s take a look at our other image
<code>sub-OAS30217_T1w.nii</code>. Perform the same steps as you did for
the first image: * Segmentation * Skull Stripping * Co-registration to
standard space Run the same skull stripping and registration as you have
done before. Now open up both standard space images in
<code>fsleyes</code></p>
<p><em>What do you observe about the images?</em></p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>TODO: Provide solution</p>
</div>
</div>
</div>
</div>
<div id="bonus-exercise-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="bonus-exercise-4" class="callout-inner">
<h3 class="callout-title">BONUS Exercise 4<a class="anchor" aria-label="anchor" href="#bonus-exercise-4"></a>
</h3>
<div class="callout-content">
<p>Let’s now try to co-register two imaging modalities from one
participant (<em>within-subject registration</em>)</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">cd</span> ~/data/ExtraStructuralMRI</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">ls</span></span></code></pre>
</div>
<p>At the end of the previous session on data visualization, you looked
at a T1-weighted scan and a FLAIR scan from the same participant
(<code>sub-OAS30003_T1w.nii.gz</code> and
<code>sub-OAS30003_FLAIR.nii.gz</code>, load them again in FSLeyes if
you need a refresh). As you will have noticed, they have different
dimensions, resolution and orientation, so if we want to look at the
same point in the brain in both images we need to align them.</p>
<p>First, we need to choose which image we want to keep unchanged
(<em>reference</em>) and which one we want to align to the reference
(<em>input</em>). Let’s assume we want to register the FLAIR image to
the T1. We have already prepared a skull-stripped version of the images
for you so they are ready to be aligned with <a href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FLIRT" class="external-link">FLIRT</a>.</p>
<p>The way to do this is very similar to what you did before to
co-register a T1 to standard space. Please follow the steps below: 1. On
the terminal window, type <code>Flirt</code> 1. This will open the
dialog box you used before. The new settings are: 1. For reference
image, delete the text in the box and type
<code>~/data/ExtraStructuralMRI</code>, then click on the folder icon
and choose the image <code>sub-OAS30003_T1w_brain.nii.gz</code> 1.
Change the Model/DOF (input to ref) to
<code>Rigid Body (6 parameter model)</code> 1. For the input image,
click on the folder icon and choose the image
<code>sub-OAS30003_FLAIR_brain.nii.gz</code> 1. For the output image,
please type in a new name
<code>sub-OAS30003_FLAIR_to_T1w.nii.gz</code></p>
<p>The final command setup should look like the screenshot below: <img src="../fig/aic_smri_flirt_T1FLAIR.png" alt="Coregistration of T1 and FLAIR" class="figure"></p>
<p>If your window looks like this, then click the <strong>Go</strong>
button at the bottom, in the terminal, you will see the <em>command
line</em> program that would run what you have set up in the dialog box.
If you were to select that command and run it in the terminal it would
do the same thing.</p>
<p>Once done, open the result in FSLeyes:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">fsleyes</span> sub-OAS30003_T1w_brain.nii.gz sub-OAS30003_FLAIR_to_T1w.nii.gz <span class="kw">&amp;</span></span></code></pre>
</div>
<p>We can now check if our image is registered by flicking back and
forth between the T1 image and the FLAIR registered image.</p>
<p><em>Can you think of why the registered FLAIR image appears blurred
in the sagittal and coronal plane?</em></p>
<p>Now try to do the opposite: co-register the T1 to the FLAIR.</p>
<p><em>What differences do you notice with respect to the previous case
(FLAIR co-registered to T1)?</em></p>
<p><em>Can you think of different cases where you would want to use T1
or FLAIR as your reference?</em></p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>TODO: add key points to solution</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Structural MRI provides high-resolution anatomic information for
neuroimaging analysis</li>
<li>Bias correction removes image inhomogeneities</li>
<li>Tissue segmentation identifies key tissue types (grey matter, white
matter, cerebrospinal fluid) from T1 weighted images</li>
<li>Co-registration of MRI to other modalities can be used to analyse
these images at a regional level.</li>
</ul></div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/imaging-data-structure-and-formats.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/pet-imaging.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/imaging-data-structure-and-formats.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Imaging Data:
        </a>
        <a class="chapter-link float-end" href="../instructor/pet-imaging.html" rel="next">
          Next: Processing and... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/HealthBioscienceIDEAS/aaic2024-neuroimaging-workshop/edit/main/episodes/structural-mri.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/HealthBioscienceIDEAS/aaic2024-neuroimaging-workshop/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/HealthBioscienceIDEAS/aaic2024-neuroimaging-workshop/" class="external-link">Source</a></p>
				<p><a href="https://github.com/HealthBioscienceIDEAS/aaic2024-neuroimaging-workshop/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:d.cash@ucl.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/HealthBioscienceIDEAS/sandpaper/tree/IDEAS" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/a32a7836d4455f407c3cafe8ab95edc636e5e919" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/HealthBioscienceIDEAS/varnish/tree/IDEAS" class="external-link">varnish (1.0.3.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://HealthBioscienceIDEAS.github.io/aaic2024-neuroimaging-workshop/instructor/structural-mri.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "medical imaging, MRI, visualization, PET, Alzheimers disease",
  "name": "Structural MRI: Bias Correction, Segmentation and Image Registration",
  "creativeWorkStatus": "active",
  "url": "https://HealthBioscienceIDEAS.github.io/aaic2024-neuroimaging-workshop/instructor/structural-mri.html",
  "identifier": "https://HealthBioscienceIDEAS.github.io/aaic2024-neuroimaging-workshop/instructor/structural-mri.html",
  "dateCreated": "2024-06-04",
  "dateModified": "2024-06-23",
  "datePublished": "2024-06-23"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

